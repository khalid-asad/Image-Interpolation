f(x,y) = a00 + a10*x + a01*y + a20*(x^2) + a11*x*y + a02*(y^2) + a21*(x^2)*y + a12*x*(y^2) + a22*(x^2)*(y^2) + a30*(x^3) + a03*(y^3) + a31*(x^3)*y + a13*x*(y^3) + a32*(x^3)*(y^2)+ a23*(x^2)*(y^3) + a33*(x^3)*(y^3);
 
w0 = a00;
w1 = a00 + a10 + a20 + a30;
w2 = a00 + a01 + a02 + a03;
w3 = a00 + a10 + a20 + a30 + a01 + a11 + a21 + a31 + a02 + a12 + a22 + a32 + a03 + a13 + a23 + a33;
 
x0 = a10;
x1 = a10 + 2*a20 + 3*a30;
x2 = a10 + a11 + a12 + a13;
x3 = 1*(a10 + a11 + a12 + a13) + 2*(a20 + a21 + a22 + a23) + 3*(a30 + a31 + a32 + a33);
 
y0 = a01;
y1 = a01 + a11 + a21 + a31;
y2 = a01 +2*a02 + 3*a03;
y3 = 1*(a01+a11+a21+a31) + 2*(a02+a12+a22+a32) + 3*(a03+a13+a23+a33);
 
z0 = a11;
z1 = a11 + 2*a21 + 3*a31;
z2 = a11 + 2*a12 + 3*a13;
z3 = 1*a11 + 2*a12 + 3*a13 + 2*a21 + 4*a22 + 6*a23 + 3*a31 + 6*a32 + 9*a33;

a00 = w0;
a01 = y0;
a02 = -3*w0 + 3*w2 -2*y0 - y2;
a03 = 2*w0 - 2*w2 + y0 + y2;
a10 = x0;
a11 = z0;
a12 = -3*x0 + 3*x2 - 2*z0 - z2;
a13 = 2*x0 - 2*x2 + z0 + z2;
a20 = -3*w0 + 3*w1 - 2*x0 - x1;
a21 = -3*y0 + 3*y1 - 2*z0 - z1;
a22 = 9*w0 - 9*w1 - 9*w2 + 9*w3 + 6*x0 + 3*x1 -6*x2 -3*x3 + 6*y0 - 6*y1 + 3*y2 - 3*y3 + 4*z0 + 2*z1 + 2*z2 + z3;
a23 = -6*w0 + 6*w1 + 6*w2 - 6*w3 -4*x0 -2*x1 + 4*x2 + 2*x3 -3*y0 + 3*y1 - 3*y2 + 3*y3 + -2*z0 - z1 - 2*z2 - z3;
a30 = 2*w0 - 2*w1 + x0 + x1;
a31 = 2*y0 - 2*y1 + z0 + z1;
a32 = -6*w0 + 6*w1 + 6*w2 -6*w3 -3*x0 - 3*x1 + 3*x2 + 3*x3 -4*y0 + 4*y1 - 2*y2 + 2*y3 + -2*z0 - 2*z1 - z2 - z3;
a33 = 4*w0 - 4*w1 - 4*w2 + 4*w3 + 2*x0 + 2*x1 + -2*x2 - 2*x3 + 2*y0 - 2*y1 + 2*y2 - 2*y3 + z0 + z1 + z2 + z3;